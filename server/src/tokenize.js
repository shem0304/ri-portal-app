// Lightweight keyword tokenizer for Korean/English titles.
// NOTE: For production, replace with a proper Korean morphological analyzer.

const DEFAULT_STOPWORDS = new Set([
  '연구', '보고서', '분석', '정책', '방안', '조사', '발전', '활성화', '현황', '추진', '계획',
  '및', '등', '대한', '위한', '관련', '중심으로', '기반', '개선', '평가', '사례',
  'the', 'and', 'for', 'with', 'from', 'into', 'to', 'of', 'in', 'on',
    // 조사/연결어
  "및", "위한", "대한", "관한", "따른", "통한", "관련", "중심으로", "대상", "방향", "현황",
  "사례", "비교", "적용", "검토", "평가", "조사", "분석", "연구",
  // 보고서/계획/용역 류
  "방안", "대응방안", "발전방안", "개선", "개선방안", "전략", "계획", "기본계획", "기본구상", "수립",
  "용역", "연구용역", "기초연구", "타당성", "타당성검토", "마스터플랜",
  // 매우 일반적인 동사/형용
  "효율적", "미치는", "필요", "추진", "활용", "활성화", "활성화를", "제고", "강화", "확대",
  // 숫자/회차
  "1차", "2차", "3차", "4차", "5차",
  "서울", "부산", "대구", "인천", "광주", "대전", "울산", "세종",
  "경기", "강원", "충북", "충남", "전북", "전남", "경북", "경남", "제주",
  "서울시", "부산시", "대구시", "인천시", "광주시", "대전시", "울산시", "세종시",
  "경기도", "강원도", "충청북도", "충청남도", "전라북도", "전라남도", "경상북도", "경상남도", "제주도",
  "서울특별시", "부산광역시", "대구광역시", "인천광역시", "대전광역시", "광주광역시", "울산광역시", "세종특별자치시",
  "기본", "발전", "동해안", "강원도의", "시사점", "영향과", "영향", "추진", "추진방안", "조성방안", "중장기", "활용방안", "육성을", "대응", "정책", "현황과", "대비", "발굴", "공모", "유치", "운영방안", "방안에", "관리방안", "제1차", "도입방안", "구상", "학술용역",
"함의", "새천년", "적합한", "분류", "지정", "종합계획", "시행계획", "육성", "작성", "발전계획", "관리방안", "예정지", "건립", "지역의",
"여부", "육성방안", "수립을", "강원의", "평가와", "육성방안", "발전방향", "역할", "개념과", "수립을", "만들기", "조성사업", "운영사업", "강원권", "지역경제에", "수정계획", "운영사업", "조성사업", "만들기", "육성방안", "지역조성사업", "구축방안", "발전전략",
"기획", "실태조사", "경쟁력", "대전지역", "구축방안", "활용한", "2017년", "2018년사업", "2019년", "2016년", "기획", "비공개",
"지원", "육성방안", "2020년", "2021년", "2022년", "사업", "2024년", "2025년", "대전의", "모색", "효과", "설치", "실적", "지역경제활성화를", "경남의", "함안", "하동", "조성부지내", "관련된", "향후", "역할과", "유치방안", "개발계획", "가칭", "제2차", "대응과제",
"파급효과", "울산지역", "강화방안", "대응전략", "수립용역", "지원방안", "설립", "지역", "2018년", "지원방안", "기초", "추진전략", "변화에", "2015년", "기반", "원문", "기본방향", "기초", "분야", "설립", "정책방향", "대구경북", "합리적", "설치", "탐색", "모색", "경영실적평가", "조성을", "가능성", "도출", "제안", "충북의", "포항", "특성", "마련", "2023기본", "2024기본", "실태와", "광주전남", "정책과제", "2014년", "2012년", "설정", "충남의", "보고서", "study", "충청권", "경제적", "산업디자인팀", "of실태와", "on", "대안", "소도읍", "일본의", "일본", "실태분석", "충북지역", "충북의", "유치전략", "행사계획", "충북지역", "2002년", "영산간", "경남관광", "종합대책", "2025년기본", "2025기본", "24년", 
"대응한", "22년", "19년", "연구과제", "현안보고", "주요", "서울형", "위해", "18년", "이용한", "고려한", "institute", "of", "소규모", "경기도의", "분석과", "전망", "변화", "제주지역", "연구보고서", "대구정책연구원", "완료", "서울의", "검토와", "효율적인", "정책연구총서",
"인천지역", "연계한", "구축을", "도입에", "부산지역", "부산의", "부산형", "울산의", "울산지역", "경북지역", "경북의", "경북형", "대전형", "중심으로", "따른"
]);

export function tokenizeTitle(title, stopwords = DEFAULT_STOPWORDS) {
  if (!title) return [];
  const cleaned = String(title)
    .replace(/\([^)]*\)/g, ' ') // remove parentheses
    .replace(/[\u2010-\u2015]/g, '-')
    .replace(/[^0-9A-Za-z\u3131-\u318E\uAC00-\uD7A3\s-]/g, ' ') // keep ko/en/digit
    .replace(/\s+/g, ' ')
    .trim();

  // Split by spaces and hyphens.
  const raw = cleaned.split(/[\s-]+/g).filter(Boolean);

  // Filter: length>=2, not purely digits, not stopword.
  return raw
    .map(t => t.trim())
    .filter(t => t.length >= 2)
    .filter(t => !/^\d+$/.test(t))
    .filter(t => !stopwords.has(t.toLowerCase()) && !stopwords.has(t));
}

export function buildStopwords(extra = []) {
  const s = new Set(DEFAULT_STOPWORDS);
  for (const w of extra) if (w) s.add(String(w).trim());
  return s;
}
